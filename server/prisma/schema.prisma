generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model SensorReading {
  id        String   @id @default(cuid())
  timestamp DateTime @default(now()) @db.Timestamptz(6)

  // Sensor values
  temperature   Float? @map("temp")
  humidity      Float? @map("hum")
  gasLevel      Int?   @map("gas")
  flameDetected Int?   @map("flame") // 0 = no flame, 1 = flame detected

  // Relations
  deviceCode String
  device     Device @relation(fields: [deviceCode], references: [code])

  @@index([timestamp(desc)])
  @@index([deviceCode, timestamp(desc)])
  @@map("sensor_readings")
}

model Device {
  id          String  @id @default(cuid())
  code        String  @unique
  description String?
  isActive    Boolean @default(true) @map("is_active")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  readings SensorReading[]

  @@map("devices")
}
